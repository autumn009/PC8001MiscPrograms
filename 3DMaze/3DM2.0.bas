2 REM 3 Dimentions Maze Ver.2.0  by A.K.
6 REM      Nov.8,1980
7 REM   Copyright 1981 by WYQ
50 WIDTH80,25:CONSOLE0,25,0,0:COLOR0,0,1:PRINTCHR$(12)
60 CLEAR300,&Hde33:DEFINTA-Z
65 GOSUB30000:GOSUB20000
67 DEFUSR0=&Hde34
70 MX=14:MY=14
80 DIM M(MX,MY),TA(3)
90 X9=79:Y9=49:A=2:XP=80:YP=50
92 X0=(X9+(X9*0.4))*(A/(A+1))
93 Y0=(Y9+(Y9*0.4))*(A/(A+1))
95 RESTORE95:FORI=0TO3:READTA(I):NEXT:DATA-1,1,1,-1
100 GY=INT(RND(1)*(MY-2))+1:GOSUB10000:MA=INT(RND(1)*4)
1000 I=0:WA=0
1020 IFMA=0ORMA=3THENI=I-1:ELSEI=I+1
1040 IFMA=0ORMA=2THENX=WX:Y=WY+I:ELSEX=WX+I:Y=WY
1060 IFM(X,Y)=0AND(X<>MX)THEN1020:ELSEEN=ABS(I)-1:IFY=GYANDX=MXTHENWA=1:EN=EN+1
1080 ST=TA(MA):WL=0:WR=0
1090 IFMA=0THENIX=-1
1092 IFMA=1THENIY=-1
1094 IFMA=2THENIX=1
1096 IFMA=3THENIY=1
1099 COLOR4:LOCATE20,0:PRINT"  drawing...  ";:COLOR0,0,1:OUT0,USR0(0)
1100 PRINTCHR$(12):ONMA+1GOTO2000,2500,2000,2500
2000 X1=X0:Y1=Y0
2002 IFM(WX-IX,WY)=0THENGOSUB5500:ELSEGOSUB5550
2004 IFM(WX+IX,WY)=0THENGOSUB5600:ELSEGOSUB5650
2018 IFABS(EN)=0THENGOSUB5400:GOTO2260:ELSEFORI=0TOST*(EN-1)STEPST
2020 X2=X1:X1=X0*(A/(ABS(I)+A))
2040 Y2=Y1:Y1=Y0*(A/(ABS(I)+A))
2100 IFM(WX-IX,WY+I)=0THENLINE(X2+XP,YP-Y2)-(X2+XP,YP+Y2),PSET:LINE(X1+XP,YP-Y1)-(X2+XP,YP+Y1),PSET,B:ELSELINE(X1+XP,YP-Y1)-(X2+XP,YP-Y2),PSET:LINE(X1+XP,YP+Y1)-(X2+XP,YP+Y2),PSET
2120 IFM(WX+IX,WY+I)=0THENLINE(XP-X2,YP-Y2)-(XP-X2,YP+Y2),PSET:LINE(XP-X1,YP-Y1)-(XP-X2,YP+Y1),PSET,B:ELSELINE(XP-X1,YP-Y1)-(XP-X2,YP-Y2),PSET:LINE(XP-X1,YP+Y1)-(XP-X2,YP+Y2),PSET
2130 BEEP1:BEEP0
2140 NEXT
2160 X2=X1:X1=X0*(A/(ABS(I)+A))
2180 Y2=Y1:Y1=Y0*(A/(ABS(I)+A))
2200 IFM(WX,WY+ST)=1THENGOSUB 5400:GOTO2260
2220 IFM(WX-IX,WY+I)=0THENGOSUB5120:ELSEGOSUB5180
2230 BEEP1:BEEP0
2240 IFM(WX+IX,WY+I)=0THENGOSUB5260:ELSEGOSUB5320
2260 GOTO8000
2500 X1=X0:Y1=Y0
2502 IFM(WX,WY-IY)=0THENGOSUB5500:ELSEGOSUB5550
2504 IFM(WX,WY+IY)=0THENGOSUB5600:ELSEGOSUB5650
2518 IFABS(EN)=0THENGOSUB5400:GOTO2760:ELSEFORI=0TOST*(EN-1)STEPST
2520 X2=X1:X1=X0*(A/(ABS(I)+A))
2540 Y2=Y1:Y1=Y0*(A/(ABS(I)+A))
2600 IFM(WX+I,WY-IY)=0THENLINE(X2+XP,YP-Y2)-(X2+XP,YP+Y2),PSET:LINE(X1+XP,YP-Y1)-(X2+XP,YP+Y1),PSET,B:ELSELINE(X1+XP,YP-Y1)-(X2+XP,YP-Y2),PSET:LINE(X1+XP,YP+Y1)-(X2+XP,YP+Y2),PSET
2620 IFM(WX+I,WY+IY)=0THENLINE(XP-X2,YP-Y2)-(XP-X2,YP+Y2),PSET:LINE(XP-X1,YP-Y1)-(XP-X2,YP+Y1),PSET,B:ELSELINE(XP-X1,YP-Y1)-(XP-X2,YP-Y2),PSET:LINE(XP-X1,YP+Y1)-(XP-X2,YP+Y2),PSET
2630 BEEP1:BEEP0
2640 NEXT
2660 X2=X1:X1=X0*(A/(ABS(I)+A))
2680 Y2=Y1:Y1=Y0*(A/(ABS(I)+A))
2700 IFM(WX+ST,WY)=1THENGOSUB 5400:GOTO2760
2720 IFM(WX+I,WY-IY)=0THENGOSUB5120:ELSEGOSUB5180
2730 BEEP1:BEEP0
2740 IFM(WX+I,WY+IY)=0THENGOSUB5260:ELSEGOSUB3584LETPUT
GOTO8000
5120 LINEX2+XP,YP-Y2)-(X2+XP,YP+Y2),PSET
5140 LINE(X2+XP,YP-Y1)-(XP,YP-Y1),PSET:LINE(X2+XP,YP+Y1)-(XP,YP+Y1),PSET
5160 RETURN
5180 LINE(X1+XP,YP-Y1)-(X2+XP,YP-Y2),PSET:LINE(X1+XP,YP+Y1)-(X2+XP,YP+Y2),PSET
5200 LINE(X1+XP,YP-Y1)-(X1+XP,YP+Y1),PSET
5220 IFWA=0THENLINE(X1+XP,YP-Y1)-(XP,YP-Y1),PSET:LINE(X1+XP,YP+Y1)-(XP,YP+Y1),PSET
5240 RETURN
5260 LINE(XP-X2,YP-Y2)-(XP-X2,YP+Y2),PSET
5280 LINE(XP-X2,YP-Y1)-(XP-1,YP-Y1),PSET:LINE(XP-X2,YP+Y1)-(XP-1,YP+Y1),PSET
5300 RETURN
5320 LINE(XP-X1,YP-Y1)-(XP-X2,YP-Y2),PSET:LINE(XP-X1,YP+Y1)-(XP-X2,YP+Y2),PSET
5340 LINE(XP-X1,YP-Y1)-(XP-X1,YP+Y1),PSET
5360 IFWA=0THENLINE(XP-X1,YP-Y1)-(XP,YP-Y1),PSET:LINE(XP-X1,YP+Y1)-(XP,YP+Y1),PSET
5380 RETURN
5400 LINE(X0+XP,YP-Y0)-(XP-X0,YP-Y0),PSET:LINE(X0+XP,YP+Y0)-(XP-X0,YP+Y0),PSET
5420 IFWR=1THENLINE(X0+XP,YP-Y0)-(X0+XP,YP+Y0),PSET
5430 IFWL=1THENLINE(XP-X0,YP-Y0)-(XP-X0,YP+Y0),PSET
5450 RETURN
5500 LINE(X0+XP,YP-Y0)-(X9+XP,YP-Y0),PSET:LINE(X0+XP,YP+Y0)-(X9+XP,YP+Y0),PSET:RETURN
5550 WR=1:LINE(X0+P,YP-Y0)-(X9+XP,YP-Y9+1),PSET:LINE(X0+XP,YP+Y0)-(X9+XP,YP+Y9+1),PSET:RETURN
5600 LINE(XP-X0,YP-Y0)-(XP-X9,YP-Y0),PSET:LINE(XP-X0,YP+Y0)-(XP-X9,YP+Y0),PSET:RETURN
5650 WL=1:LINE(XPX0,YP-Y0)-(XP-X9,YP-Y9),PSET:LINE(XP-X0,YP+Y0)-(XP-X9,YP+Y9),PSET:RETURN
8000 IF WA=1 THENGOTO15000
8010 WIDTH80,25:I$=INPUT$(1)
8015 BEEP1:FORI=0TO300:NEXT:BEEP0
8020 IFI$=","THENI=-1:ONMA+1GOSUB8260,8280,8220,8240
8040 IFI$="5"THENI=1:ONMA+1GOSUB8260,8280,8220,8240
8060 IFI$="1"THENMA=MA-1:IFMA=-1THENMA=3
8080 IFI$="3"THENMA=(MA+1)MOD4
8100 IFI$="*"THENGOSUB12000:GOTO8000
8120 IF(M(WX,WY)=0)AND(WX<>MX)THEN8200
8140 IFI$=","THENI$="5":GOTO8180
8160 IFI$="5"THENI$=","
8180 BEEP:GOTO8020
8200 GOTO1000
8220 WY=WY+I:RETURN
8240 WX=WX+(-I):RETURN
8260 WY=WY+(-I):RETURN
8280 WX=WX+I:RETURN
10000 OF=MX*MY/24
10005 ERASE M:DIM M(MX,MY)
10010 LOCATE20,24:PRINT"I'm making maze.  Please wait.  ";
10020 FORX=0TOMX:M(X,0)=1:M(X,MY)=1:NEXT
10040 FORY=0TOMY:M(0,Y)=1:M(MX,Y)=1:NEXT
10060 FORX=2TOMX-2STEP2:FORY=2TOMY-2STEP2:M(X,Y)=1:NEXT:NEXT
10080 FORI=0TOOF
10100 PRINTCHR$(11)I;
10120 X=INT(RND(1)*((MX-2)/2))*2+1
10140 Y=INT(RND(1)*((MY-1)/2))*2
10160 M(X,Y)=1
10180 X=INT(RND(1)*((MX-2)/2))*2+1
10200 Y=INT(RND(1)*((MY-1)/2))*2
10220 M(X,Y)=1
10240 X=INT(RND(1)*((MX-1)/2))*2
10260 Y=INT(RND(1)*((MY-1)/2))*2+1
10280 M(X,Y)=1
10300 X=INT(RND(1)*((MX-1)/2))*2
10320 Y=INT(RND(1)*((MY-1)/2))*2+1
10340 M(X,Y)=1
10360 NEXT:J=0
10380 X=INT(RND(1)*(MX-1)/2)*2+1
10400 Y=INT(RND(1)*(MY-1)/2)*2+1
10420 I=0:J=J+1:IFJ>30THENBEEP:GOTO10000
10440 IFM(X+1,Y)=0THENI=I+1
10460 IFM(X,Y+1)=0THENI=I+1
10480 IFM(X-1,Y)=0THENI=I+1
10500 IFM(X,Y-1)=0THENI=I+1
10520 IFI<3THEN10380
10540 WX=X:WY=Y
10560 M(MX,GY)=0  :RETURN
12000 LOCATE0,2:FORY=0TOMY:FORX=0TOMX
12020 IFX=WXTHENIFY=WYTHENPRINTMID$("δεμ-ζη-μ",MA*2+1,2);:GOTO12060
12040 IFM(X,Y)=1THENPRINT"‡‡";:ELSEPRINT"  ";
12060 NEXT:PRINT:NEXT:RETURN
15000 REM
15100 IFWX<>MX-1THENLINE(XP-X1+1,YP-Y1)-(XP+X1-1,YP+Y1),PSET,BF:BEEP1:BEEP0:GOTO8010
15140 LINE(XP-X1+1,YP-Y1)-(XP-X1+1,YP+Y1),PSET
15200 X=(XP-X1+1)/2+1:Y=(YP-Y1)/4
15202 COLOR4
15210 LOCATEX,Y   :PRINT"   ο  –  ξ                                     "
15212 LOCATEX,Y+1 :PRINT"    ο – ξ                   •••••            "
15214 LOCATEX,Y+2 :PRINT"     •                   ••              "
15216 LOCATEX,Y+3 :PRINT"  •••– –•••••••            ‘   ••‘           "
15218 LOCATEX,Y+4 :PRINT"     •                    •••••            "
15220 LOCATEX,Y+5 :PRINT"    ξ – ο                              ‡       "
15222 LOCATEX,Y+6 :PRINT"   ξ  –  ο                          δ‡ε‡       "
15224 LOCATEX,Y+7 :PRINT"  ξ   –   ο      δε                δ‡‡‡‡       "
15226 LOCATEX,Y+8 :PRINT"      –    ο     δε               δ‡‡‡‡‡ε      "
15228 LOCATEX,Y+9 :PRINT"            ο   δ‡‡ε             δ‡‡‡‡‡‡‡ε     "
15230 LOCATEX,Y+10:PRINT"  €€€            —‰               ‡‡‡‡‡     €"
15232 LOCATEX,Y+11:PRINT"””,,,”•€ €€€•••””””••••€€€€€€€€•••‡‡‡‡‡‡‡••””””"
15236 LOCATEX,Y+12:PRINT" ,,,,,,,,,,   ,,,,,  ,,,,,,,,,,, , ,,,,,,,,,,  "
15238 LOCATEX,Y+13:PRINT"     ,,,,,, ,,,,,,,,,,,,,,,,,,,                "
15240 LOCATEX,Y+14:PRINT"      ,,,,,,,,,,,,,,               ,,,,,       "
15300 WIDTH80,25:FORI=0TO5:BEEPRND(1)+0.5:FORJ=0TO100:NEXT:NEXT:BEEP0
15302 COLOR0
15320 LOCATE10,0:PRINT"You get to the exit!";
15340 LOCATE27,1:PRINT"Push any key, then you can play again. ";
15360 I$=INKEY$:IFI$=""THEN15360
15380 PRINTCHR$(12):GOTO100
20000 PRINTCHR$(12);
20010 LOCATE10,3:PRINT"*****  3 Dimentions  Maze   *****"
20020 LOCATE17,6:PRINT"Do you need to explain ?"
20040 LOCATE27,7:PRINT"Key in Yes or No. *"CHR$(29);
20050 I$=INPUT$(1):PRINT" ";
20060 LOCATE45,7:IFI$="n"ORI$="N"THENPRINT"  [ No. ]":GOTO20170 :ELSEPRINT"  [ Yes ]";
20070 LOCATE10,10:PRINT"You will be in Maze."
20080 LOCATE12,11:PRINT"Then you have to go to the exit."
20090 LOCATE11,128:PRINT"If you want to walk, you can use the+ commands."
20100 LOCATE15,14:PRINT"[ 5 ]key   walk forward one step"
20110 LOCATE15,15:PRINT"[ , ]key   walk backward one step"
20120 LOCATE15,16:PRINT"[ 1 ]key   turn left"
20130 LOCATE15,17:PRINT"[ 3 ]key   turn right"
20140 LOCATE10,18:PRINT" If you want to watch the maze outside, you can use this command."
20150 LOCATE15,19:PRINT"[ * ]key   watch Maze"
20170 LOCATE8 ,21:PRINT"Shall we go into the maze ?     [ Push any key, then start. ]  *"CHR$(29);
20999 I$=INPUT$(1):PRINT" Ok":RETURN
30000 RESTORE38000:FORI=&Hde34TO&Hde47:READV$:POKEI,VAL("&h"+V$):NEXT:RETURN
38000 DATA21,00,F3,11,48,DE,01,B8,0B
38020 DATAED,B0,3E,48,D3,66,3E,DE,D3,66,C9
